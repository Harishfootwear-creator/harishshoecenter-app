<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1e3a8a">
    <meta name="description" content="Harish Footwear - Wholesale distributor of premium footwear brands. Budget Shoe Bazaar with unbeatable wholesale prices.">
    <title>Harish Footwear - Wholesale Distributor</title>

    <style>
        :root {
            --color-primary: #1e3a8a;
            --color-primary-hover: #1e40af;
            --color-accent: #f97316;
            --color-accent-hover: #ea580c;
            --color-background: #fafaf9;
            --color-surface: #ffffff;
            --color-text: #111827;
            --color-text-secondary: #6b7280;
            --color-border: #e5e7eb;
            --color-success: #10b981;
            --color-error: #ef4444;
        }

        @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-20px)} }
        @keyframes fadeIn { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
        @keyframes slideIn { from{opacity:0;transform:translateX(-30px)} to{opacity:1;transform:translateX(0)} }
        @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.8} }

        *{box-sizing:border-box;margin:0;padding:0}

        body{
            font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
            background:linear-gradient(135deg,#fafaf9 0%,#f5f5f4 50%,#e7e5e4 100%);
            color:var(--color-text);
            line-height:1.6;
            position:relative;
            overflow-x:hidden;
            scroll-behavior:smooth;
        }
        body::before{
            content:'';
            position:fixed;
            inset:0;
            background:
                radial-gradient(circle at 20% 50%,rgba(30,58,138,.05) 0%,transparent 50%),
                radial-gradient(circle at 80% 80%,rgba(249,115,22,.05) 0%,transparent 50%),
                radial-gradient(circle at 40% 20%,rgba(20,184,166,.04) 0%,transparent 50%),
                radial-gradient(circle at 60% 40%,rgba(99,102,241,.03) 0%,transparent 50%);
            animation:bgFloat 20s ease-in-out infinite;
            pointer-events:none;
            z-index:0;
        }
        @keyframes bgFloat{0%,100%{opacity:1}50%{opacity:.7}}
        body>*{position:relative;z-index:1}

        nav{
            background:var(--color-text);
            color:#fff;
            padding:1rem 2rem;
            display:flex;
            justify-content:space-between;
            align-items:center;
            box-shadow:0 2px 4px rgba(0,0,0,.1);
        }
        .logo{font-size:1.5rem;font-weight:700;display:flex;align-items:center;gap:.5rem}
        .nav-links{display:flex;gap:2rem;list-style:none}
        .nav-links a{color:#fff;text-decoration:none;transition:opacity .3s}
        .nav-links a:hover{opacity:.8}

        .admin-badge{
            position:fixed;top:20px;right:20px;
            background:linear-gradient(135deg,var(--color-primary),var(--color-accent));
            color:#fff;padding:.75rem 1.5rem;border-radius:30px;
            font-weight:600;font-size:.875rem;
            box-shadow:0 4px 12px rgba(0,0,0,.15);
            z-index:1001;display:none;align-items:center;gap:.5rem;
            animation:slideInRight .5s ease-out;cursor:pointer;transition:all .3s;
        }
        .admin-badge.visible{display:flex}
        @keyframes slideInRight{from{opacity:0;transform:translateX(100px)}to{opacity:1;transform:translateX(0)}}

        .hero{
            background:linear-gradient(135deg,#1e3a8a 0%,#3b82f6 50%,#f97316 100%);
            color:#fff;padding:4rem 2rem;text-align:center;position:relative;overflow:hidden;
        }
        .hero::before{
            content:'üëü';position:absolute;top:10%;left:10%;font-size:4rem;
            opacity:.1;animation:float 6s ease-in-out infinite;
        }
        .hero::after{
            content:'üëû';position:absolute;bottom:10%;right:10%;font-size:4rem;
            opacity:.1;animation:float 6s ease-in-out infinite 3s;
        }
        .hero h1{font-size:2.5rem;margin-bottom:1rem;animation:fadeIn 1s ease-out}
        .hero p{
            font-size:1.2rem;opacity:.95;max-width:600px;margin:0 auto 2rem;
            animation:fadeIn 1.2s ease-out;
        }
        .hero-badges{display:flex;justify-content:center;gap:2rem;flex-wrap:wrap;animation:fadeIn 1.4s ease-out}
        .badge{
            background:rgba(255,255,255,.2);padding:.5rem 1rem;border-radius:20px;
            backdrop-filter:blur(10px);animation:pulse 2s ease-in-out infinite;transition:transform .3s;
        }
        .badge:hover{transform:scale(1.1);background:rgba(255,255,255,.3)}

        .container{max-width:1200px;margin:0 auto;padding:3rem 2rem;background:transparent}
        .section-title{font-size:2rem;text-align:center;margin-bottom:2rem}

        .products-grid{
            display:grid;
            grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
            gap:2rem;margin-bottom:3rem;
        }
        .product-card{
            background:#fff;border:1px solid var(--color-border);border-radius:12px;
            overflow:hidden;transition:transform .3s,box-shadow .3s,border-color .3s;
            cursor:pointer;animation:fadeIn .6s ease-out;position:relative;
        }
        .product-controls{
            position:absolute;top:10px;right:10px;display:none;
            flex-direction:column;gap:.5rem;z-index:10;
        }
        .admin-badge.visible ~ .container .product-card .product-controls{display:flex}
        .product-control-btn{
            background:var(--color-primary);color:#fff;border:none;
            width:32px;height:32px;border-radius:50%;cursor:pointer;
            display:flex;align-items:center;justify-content:center;
            font-size:1rem;transition:all .3s;box-shadow:0 2px 8px rgba(0,0,0,.2);
        }
        .product-control-btn:hover{background:var(--color-primary-hover);transform:scale(1.1)}
        .product-control-btn:disabled{opacity:.5;cursor:not-allowed}
        .product-card:hover{
            transform:translateY(-8px);
            box-shadow:0 12px 24px rgba(30,58,138,.15);
            border-color:var(--color-primary);
        }

        .product-image{
            width:100%;height:200px;background:var(--color-surface);
            display:flex;align-items:center;justify-content:center;
            font-size:3rem;border-bottom:1px solid var(--color-border);
            overflow:hidden;position:relative;
        }
        .product-image img{width:100%;height:100%;object-fit:contain;background:#fff;display:block}
        .product-image-emoji{font-size:3rem}
        .product-article{font-size:.75rem;color:var(--color-text-secondary);margin-top:.25rem}
        .product-description{font-size:.875rem;color:var(--color-text-secondary);margin-top:.5rem;line-height:1.4}
        .product-info{padding:1.5rem}
        .product-brand{font-size:.875rem;color:var(--color-text-secondary);font-weight:600;text-transform:uppercase}
        .product-name{font-size:1.125rem;font-weight:600;margin:.5rem 0}
        .product-price{display:none;}
        .product-stock{font-size:.875rem;color:var(--color-success);margin-top:.5rem}

        .contact-section{background:transparent;padding:3rem 2rem}
        .contact-grid{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
            gap:2rem;max-width:1200px;margin:0 auto;
        }
        .contact-card{
            background:#fff;padding:2rem;border-radius:12px;text-align:center;
            border:1px solid var(--color-border);transition:all .3s;animation:slideIn .8s ease-out;
        }
        .contact-card:hover{
            transform:translateY(-6px);
            box-shadow:0 8px 20px rgba(30,58,138,.1);
            border-color:var(--color-primary);
            background:linear-gradient(135deg,rgba(30,58,138,.02),rgba(249,115,22,.02));
        }
        .contact-icon{font-size:2rem;margin-bottom:1rem}

        .contact-form-section{background:transparent;padding:3rem 2rem}
        .contact-form-title{font-size:2rem;text-align:left;margin-bottom:1rem;color:var(--color-text)}
        .contact-form-subtitle{
            color:var(--color-text-secondary);margin-bottom:2rem;
            line-height:1.6;max-width:800px;
        }
        .contact-form{max-width:800px;display:flex;flex-direction:column;gap:1rem}
        .contact-input,.contact-textarea{
            width:100%;padding:1rem;border:1px solid var(--color-border);
            border-radius:8px;font-size:1rem;font-family:inherit;
            background:var(--color-surface);transition:border-color .3s;
        }
        .contact-input:focus,.contact-textarea:focus{
            outline:none;border-color:var(--color-primary);
            box-shadow:0 0 0 3px rgba(37,99,235,.1);
        }
        .contact-textarea{resize:vertical;min-height:120px}
        .contact-submit-btn{
            background:var(--color-accent);color:#fff;padding:.75rem 2rem;
            border:none;border-radius:8px;font-size:1rem;font-weight:500;
            cursor:pointer;align-self:flex-start;transition:all .3s;
        }
        .contact-submit-btn:hover{
            background:var(--color-accent-hover);
            transform:translateY(-2px);
            box-shadow:0 6px 16px rgba(249,115,22,.3);
        }

        .modal{
            display:none;position:fixed;inset:0;
            background:rgba(0,0,0,.5);z-index:1000;
            align-items:center;justify-content:center;
        }
        .modal.active{display:flex}
        .modal-content{
            background:#fff;border-radius:12px;width:90%;
            max-width:800px;max-height:90vh;overflow-y:auto;
        }
        .modal-header{
            padding:1.5rem;border-bottom:1px solid var(--color-border);
            display:flex;justify-content:space-between;align-items:center;
        }
        .modal-body{padding:2rem}
        .close-btn{
            background:none;border:none;font-size:1.5rem;
            cursor:pointer;color:var(--color-text-secondary);
        }
        .close-btn:hover{color:var(--color-text)}

        .admin-tabs{
            display:flex;gap:1rem;
            border-bottom:2px solid var(--color-border);
            margin-bottom:2rem;
        }
        .admin-tab{
            padding:.75rem 1.5rem;background:none;border:none;
            cursor:pointer;font-weight:500;color:var(--color-text-secondary);
            border-bottom:2px solid transparent;margin-bottom:-2px;
            transition:all .3s;
        }
        .admin-tab.active{color:var(--color-primary);border-bottom-color:var(--color-primary)}
        .tab-content{display:none}
        .tab-content.active{display:block}

        .form-group{margin-bottom:1.5rem}
        .form-group label{display:block;margin-bottom:.5rem;font-weight:500}
        .form-control{
            width:100%;padding:.75rem;border:1px solid var(--color-border);
            border-radius:6px;font-size:1rem;font-family:inherit;
        }
        .form-control:focus{
            outline:none;border-color:var(--color-primary);
            box-shadow:0 0 0 3px rgba(37,99,235,.1);
        }

        .btn{
            padding:.75rem 1.5rem;border:none;border-radius:6px;
            font-weight:500;cursor:pointer;transition:all .3s;
        }
        .btn-primary{background:var(--color-primary);color:#fff}
        .btn-primary:hover{background:var(--color-primary-hover)}
        .btn-danger{background:var(--color-error);color:#fff}
        .btn-danger:hover{background:#dc2626}
        .btn-sm{padding:.4rem .8rem;font-size:.875rem}

        .products-table{width:100%;border-collapse:collapse;margin-top:1rem}
        .products-table th,.products-table td{
            padding:1rem;text-align:left;border-bottom:1px solid var(--color-border);
        }
        .products-table th{background:var(--color-surface);font-weight:600}
        .products-table tr:hover{background:var(--color-surface)}

        .login-form{max-width:400px;margin:0 auto}
        .alert{padding:1rem;border-radius:6px;margin-bottom:1rem}
        .alert-error{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}
        .alert-success{background:#d1fae5;color:#065f46;border:1px solid #a7f3d0}

        footer{
            background:linear-gradient(135deg,#1e3a8a 0%,#3b82f6 50%,#f97316 100%);
            color:#fff;text-align:center;padding:2rem;margin-top:3rem;
            position:relative;overflow:hidden;
        }
        footer::before{
            content:'';position:absolute;inset:0;
            background:radial-gradient(circle at 50% 50%,rgba(255,255,255,.1) 0%,transparent 70%);
            animation:footerPulse 4s ease-in-out infinite;
        }
        @keyframes footerPulse{0%,100%{opacity:.5}50%{opacity:1}}
        footer p{position:relative;z-index:1}

        @media (max-width:768px){
            .nav-links{display:none}
            .hero h1{font-size:2rem}
            .products-grid{grid-template-columns:1fr}
        }
    </style>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
</head>
<body>
<nav>
    <div class="logo">üëü Harish Footwear</div>
    <ul class="nav-links">
        <li><a href="#home">Home</a></li>
        <li><a href="#products">Products</a></li>
        <li><a href="#contact">Contact</a></li>
    </ul>
</nav>

<section class="hero" id="home">
    <h1 id="heroTitle">Budget Shoe Bazaar: Wholesale Footwear at Unbeatable Prices ‚ú®</h1>
    <p id="heroSubtitle">Explore Harish Footwear, the ultimate wholesale distributor for top brands like Nike, Adidas, Puma, and more. Providing quality footwear for all styles, occasions and budgets.</p>
    <div class="hero-badges">
        <div class="badge"><span id="badge1Icon">üèÜ</span> <span id="badge1Text">Top Brands</span></div>
        <div class="badge"><span id="badge2Icon">üí∞</span> <span id="badge2Text">Wholesale Prices</span></div>
        <div class="badge"><span id="badge3Icon">üì¶</span> <span id="badge3Text">Bulk Orders</span></div>
    </div>
</section>

<div class="container" id="products">
    <h2 class="section-title">Our Premium Collection</h2>
    <div class="products-grid" id="productsGrid"></div>
</div>

<section class="contact-form-section">
    <div class="container">
        <h2 class="contact-form-title" id="contactFormTitle">Contact Harish Footwear</h2>
        <p id="contactFormSubtitle" class="contact-form-subtitle">
            Get amazing deals on bulk orders and elevate your footwear collection by connecting with HARISH FOOTWEAR now - Fill the contact form or call -6393191774
        </p>
        <form class="contact-form" id="contactForm" onsubmit="handleContactSubmit(event)">
            <input type="text" class="contact-input" placeholder="First name" required>
            <input type="email" class="contact-input" placeholder="Email" required>
            <textarea class="contact-textarea" placeholder="Message" rows="5" required></textarea>
            <button type="submit" class="contact-submit-btn">Send</button>
        </form>
        <div id="contactAlert" style="margin-top: 1rem;"></div>
    </div>
</section>

<section class="contact-section" id="contact">
    <div class="container">
        <h2 class="section-title">Get In Touch</h2>
        <div class="contact-grid">
            <div class="contact-card" onclick="window.location.href='https://maps.app.goo.gl/qikCuAG94XLCAzia8'" style="cursor:pointer;">
                <div class="contact-icon">üìç</div>
                <h3>Location</h3>
                <p id="locationText">Bansdih, UP-277202</p>
            </div>
            <div class="contact-card" onclick="window.location.href='tel:+916393191774'" style="cursor:pointer;">
                <div class="contact-icon">üìû</div>
                <h3>Phone</h3>
                <p id="phoneText">+91 6393191774</p>
            </div>
            <div class="contact-card" onclick="window.location.href='mailto:harishfootwear950@gmail.com'" style="cursor:pointer;">
                <div class="contact-icon">‚úâÔ∏è</div>
                <h3>Email</h3>
                <p id="emailText">harishfootwear950@gmail.com</p>
            </div>
        </div>
    </div>
</section>

<div class="container" id="customSectionsContainer"></div>

<button id="aiChatButton" onclick="toggleAiChat()" style="position:fixed;bottom:20px;right:20px;width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;border:none;font-size:1.5rem;cursor:pointer;box-shadow:0 4px 12px rgba(37,99,235,.4);z-index:1000;display:flex;align-items:center;justify-content:center;">
    üí¨
</button>

<div id="aiChatWidget" style="display:none;position:fixed;bottom:90px;right:20px;width:350px;max-width:calc(100vw - 40px);background:#fff;border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,.2);z-index:1000;overflow:hidden;">
    <div style="background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;padding:1rem;display:flex;justify-content:space-between;align-items:center;">
        <div>
            <div style="font-weight:600;font-size:1.1rem;" id="assistantTitleHeader">Harish Assistant ü§ñ</div>
            <div style="font-size:.75rem;opacity:.9;" id="assistantSubtitleHeader">Ask me anything about footwear!</div>
        </div>
        <button onclick="toggleAiChat()" class="close-btn" style="background:none;border:none;color:#fff;font-size:1.5rem;cursor:pointer;padding:0;width:30px;height:30px;">√ó</button>
    </div>
    <div id="aiChatMessages" style="height:300px;overflow-y:auto;padding:1rem;background:#f9fafb;">
        <div id="assistantGreetingBlock" style="background:linear-gradient(135deg,#e0f2fe,#dbeafe);padding:.75rem;border-radius:12px;margin-bottom:.75rem;font-size:.875rem;">
            üëã Namaste! I‚Äôm Harish Footwear‚Äôs assistant.<br><br>
            I can help you with:<br>
            ‚Ä¢ Product suggestions<br>
            ‚Ä¢ Stock & size availability<br>
            ‚Ä¢ Bulk wholesale orders<br>
            ‚Ä¢ Shop location & contact<br><br>
            Type your question here or send your WhatsApp number, we‚Äôll reply quickly from +91 6393191774.
        </div>
    </div>
    <div style="padding:1rem;border-top:1px solid #e5e7eb;background:#fff;">
        <form onsubmit="handleAiChat(event)" style="display:flex;gap:.5rem;">
            <input type="text" id="aiChatInput" placeholder="Type your question..." style="flex:1;padding:.75rem;border:1px solid #e5e7eb;border-radius:8px;font-size:.875rem;" required>
            <button type="submit" class="btn btn-primary" style="background:#3b82f6;color:#fff;border:none;padding:.75rem 1rem;border-radius:8px;cursor:pointer;font-size:1rem;">‚û§</button>
        </form>
    </div>
</div>

<footer>
    <p id="footerText1">¬© 2025 Harish Footwear. All rights reserved.</p>
    <p id="footerText2">Wholesale Distributor - Nike, Adidas, Puma & More</p>
    <p id="footerText3" style="margin-top:.5rem;font-size:.875rem;opacity:.8;">üåê Website Live & Ready for Business</p>
</footer>

<div class="admin-badge" id="adminBadge" onclick="openAdminPanel()">
    <span>üë§</span><span>Admin Mode</span>
</div>

<div class="modal" id="adminModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Admin Login</h2>
            <button class="close-btn" onclick="closeAdminPanel()">√ó</button>
        </div>
        <div class="modal-body">
            <div id="loginSection">
                <div class="login-form">
                    <div id="loginAlert"></div>
                    <form onsubmit="handleLogin(event)">
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="password" class="form-control" required>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width:100%;">Login</button>
                    </form>
                </div>
            </div>

            <div id="dashboardSection" style="display:none;">
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="switchTab('analytics')">Analytics</button>
                    <button class="admin-tab" onclick="switchTab('products')">Products</button>
                    <button class="admin-tab" onclick="switchTab('messages')">Messages</button>
                    <button class="admin-tab" onclick="switchTab('add')">Add Product</button>
                    <button class="admin-tab" onclick="switchTab('sections')">Add Section</button>
                    <button class="admin-tab" onclick="switchTab('website')">Website Settings</button>
                    <button class="admin-tab" onclick="switchTab('assistant')">AI Assistant</button>
                    <button class="admin-tab" onclick="switchTab('settings')">Account</button>
                </div>

                <div id="analyticsTab" class="tab-content active">
                    <h3>Website Analytics</h3>
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin:2rem 0;">
                        <div style="background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 4px 12px rgba(37,99,235,.2);">
                            <div style="font-size:.875rem;opacity:.9;margin-bottom:.5rem;">Total Visitors</div>
                            <div style="font-size:2rem;font-weight:700;" id="totalVisitors">0</div>
                            <div style="font-size:.75rem;opacity:.8;margin-top:.5rem;">All time</div>
                        </div>
                        <div style="background:linear-gradient(135deg,#10b981,#059669);color:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 4px 12px rgba(16,185,129,.2);">
                            <div style="font-size:.875rem;opacity:.9;margin-bottom:.5rem;">Today's Visitors</div>
                            <div style="font-size:2rem;font-weight:700;" id="todayVisitors">0</div>
                            <div style="font-size:.75rem;opacity:.8;margin-top:.5rem;" id="todayDate">--</div>
                        </div>
                        <div style="background:linear-gradient(135deg,#f97316,#ea580c);color:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 4px 12px rgba(249,115,22,.2);">
                            <div style="font-size:.875rem;opacity:.9;margin-bottom:.5rem;">Page Views</div>
                            <div style="font-size:2rem;font-weight:700;" id="totalViews">0</div>
                            <div style="font-size:.75rem;opacity:.8;margin-top:.5rem;">Total</div>
                        </div>
                        <div style="background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff;padding:1.5rem;border-radius:12px;box-shadow:0 4px 12px rgba(139,92,246,.2);">
                            <div style="font-size:.875rem;opacity:.9;margin-bottom:.5rem;">Avg. Time</div>
                            <div style="font-size:2rem;font-weight:700;" id="avgTime">0:00</div>
                            <div style="font-size:.75rem;opacity:.8;margin-top:.5rem;">Minutes</div>
                        </div>
                    </div>

                    <div style="background:#fff;padding:1.5rem;border-radius:12px;border:1px solid var(--color-border);margin-top:2rem;">
                        <h4 style="margin-bottom:1rem;">Recent Activity</h4>
                        <table class="products-table">
                            <thead>
                            <tr><th>Date & Time</th><th>Type</th><th>Details</th></tr>
                            </thead>
                            <tbody id="activityLog">
                            <tr>
                                <td colspan="3" style="text-align:center;color:var(--color-text-secondary);padding:2rem;">No activity yet</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>

                    <div style="background:#fff;padding:1.5rem;border-radius:12px;border:1px solid var(--color-border);margin-top:2rem;">
                        <h4 style="margin-bottom:1rem;">Visitor Statistics</h4>
                        <div style="display:grid;gap:1rem;">
                            <div style="display:flex;justify-content:space-between;padding:.75rem;background:var(--color-surface);border-radius:6px;">
                                <span>Desktop Visitors</span><span style="font-weight:600;" id="desktopCount">0 (0%)</span>
                            </div>
                            <div style="display:flex;justify-content:space-between;padding:.75rem;background:var(--color-surface);border-radius:6px;">
                                <span>Mobile Visitors</span><span style="font-weight:600;" id="mobileCount">0 (0%)</span>
                            </div>
                            <div style="display:flex;justify-content:space-between;padding:.75rem;background:var(--color-surface);border-radius:6px;">
                                <span>Tablet Visitors</span><span style="font-weight:600;" id="tabletCount">0 (0%)</span>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top:1.5rem;padding:1rem;background:#fef3c7;border:1px solid #fbbf24;border-radius:8px;">
                        <strong style="color:#92400e;">üìä Note:</strong>
                        <p style="margin:.5rem 0 0 0;color:#92400e;font-size:.875rem;">
                            Analytics tracking is stored locally in each visitor's browser. Data starts from the first visit after this update.
                        </p>
                    </div>
                </div>

                <div id="productsTab" class="tab-content">
                    <h3>Manage Products</h3>
                    <table class="products-table">
                        <thead>
                        <tr>
                            <th>Position</th><th>Brand</th><th>Name</th><th>Price</th><th>Stock</th><th>Actions</th>
                        </tr>
                        </thead>
                        <tbody id="adminProductsList"></tbody>
                    </table>
                </div>

                <div id="messagesTab" class="tab-content">
                    <h3>Customer Messages</h3>
                    <div id="messagesList">
                        <p style="color:var(--color-text-secondary);">No messages yet.</p>
                    </div>
                </div>

                <div id="addTab" class="tab-content">
                    <h3>Add New Product</h3>
                    <p style="color: var(--color-text-secondary); margin-bottom: 1rem;">
                        All fields are optional. Public page will show brand, name, sizes and a ‚ÄúCall for price‚Äù button.
                    </p>
                    <form onsubmit="handleAddProduct(event)">
                        <div class="form-group">
                            <label for="productBrand">Brand</label>
                            <select id="productBrand" class="form-control" onchange="handleBrandSelect()">
                                <option value="Nike">Nike</option>
                                <option value="Adidas">Adidas</option>
                                <option value="Puma">Puma</option>
                                <option value="Reebok">Reebok</option>
                                <option value="__custom__">+ Add Custom Brand</option>
                            </select>
                        </div>

                        <div class="form-group" id="customBrandGroup" style="display:none;">
                            <label for="customBrandInput">Custom Brand Name</label>
                            <input type="text" id="customBrandInput" class="form-control" placeholder="Enter brand name">
                        </div>

                        <div class="form-group">
                            <label for="productName">Product Name</label>
                            <input type="text" id="productName" class="form-control">
                        </div>

                        <div class="form-group">
                            <label for="productPrice">Wholesale Price (‚Çπ)</label>
                            <input type="number" id="productPrice" class="form-control" value="0">
                        </div>

                        <div class="form-group">
                            <label for="productMrp">MRP (‚Çπ)</label>
                            <input type="number" id="productMrp" class="form-control" value="0">
                        </div>

                        <div class="form-group">
                            <label for="productDiscount">Discount (%)</label>
                            <input type="number" id="productDiscount" class="form-control" value="0" min="0" max="100">
                        </div>

                        <div class="form-group">
                            <label for="productSizes">Sizes (comma separated)</label>
                            <input type="text" id="productSizes" class="form-control" placeholder="e.g., 6,7,8,9,10">
                        </div>

                        <div class="form-group">
                            <label for="productCategory">Category</label>
                            <select id="productCategory" class="form-control">
                                <option value="">--</option>
                                <option value="Men">Men</option>
                                <option value="Women">Women</option>
                                <option value="Kids">Kids</option>
                                <option value="Unisex">Unisex</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="productColor">Color</label>
                            <input type="text" id="productColor" class="form-control" placeholder="e.g., Red/White">
                        </div>

                        <div class="form-group">
                            <label for="productImage">Image URL</label>
                            <input type="url" id="productImage" class="form-control" placeholder="https://example.com/image.jpg">
                        </div>

                        <div class="form-group">
                            <label for="productArticle">Article Number</label>
                            <input type="text" id="productArticle" class="form-control" placeholder="e.g., NK-AM270-001">
                        </div>

                        <div class="form-group">
                            <label for="productDescription">Description</label>
                            <textarea id="productDescription" class="form-control" rows="3" placeholder="Product description..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="productStock">Stock Quantity</label>
                            <input type="number" id="productStock" class="form-control">
                        </div>

                        <div class="form-group">
                            <label for="productEmoji">Emoji</label>
                            <input type="text" id="productEmoji" class="form-control" placeholder="üëü" maxlength="2">
                        </div>

                        <button type="submit" class="btn btn-primary">Add Product</button>
                    </form>
                </div>

                <div id="sectionsTab" class="tab-content">
                    <h3>Manage Sections</h3>
                    <p style="color:var(--color-text-secondary);margin-bottom:1.5rem;">
                        Add hero banners, cards, text blocks, and more. Sections appear between ‚ÄúGet In Touch‚Äù and the footer.
                    </p>

                    <div style="margin-bottom:2rem;">
                        <h4 style="margin-bottom:1rem;">Add New Section</h4>
                        <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:1rem;">
                            <button class="btn btn-primary" onclick="addSection('image')" style="padding:1rem;display:flex;flex-direction:column;align-items:center;gap:.5rem;">
                                <span style="font-size:2rem;">üñºÔ∏è</span><span>Image</span>
                            </button>
                            <button class="btn btn-primary" onclick="addSection('gallery')" style="padding:1rem;display:flex;flex-direction:column;align-items:center;gap:.5rem;">
                                <span style="font-size:2rem;">üé®</span><span>Gallery</span>
                            </button>
                            <button class="btn btn-primary" onclick="addSection('text')" style="padding:1rem;display:flex;flex-direction:column;align-items:center;gap:.5rem;">
                                <span style="font-size:2rem;">üìù</span><span>Text Block</span>
                            </button>
                            <button class="btn btn-primary" onclick="addSection('card')" style="padding:1rem;display:flex;flex-direction:column;align-items:center;gap:.5rem;">
                                <span style="font-size:2rem;">üÉè</span><span>Card</span>
                            </button>
                            <button class="btn btn-primary" onclick="addSection('hero')" style="padding:1rem;display:flex;flex-direction:column;align-items:center;gap:.5rem;">
                                <span style="font-size:2rem;">üéØ</span><span>Hero Banner</span>
                            </button>
                            <button class="btn btn-primary" onclick="addSection('spacer')" style="padding:1rem;display:flex;flex-direction:column;align-items:center;gap:.5rem;">
                                <span style="font-size:2rem;">‚¨ú</span><span>Spacer</span>
                            </button>
                        </div>
                    </div>

                    <hr style="margin:2rem 0;">
                    <h4 style="margin-bottom:1rem;">Current Sections</h4>
                    <div id="sectionsList">
                        <p style="color:var(--color-text-secondary);">No extra sections added yet.</p>
                    </div>
                </div>

                <div id="websiteTab" class="tab-content">
                    <h3>Website Text & Branding</h3>
                    <p style="color:var(--color-text-secondary);margin-bottom:1.5rem;">
                        Update hero text, contact info, and footer without editing code.
                    </p>
                    <form onsubmit="saveWebsiteSettings(event)">
                        <h4>Hero Section</h4>
                        <div class="form-group">
                            <label for="heroTitleInput">Hero Title</label>
                            <input id="heroTitleInput" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="heroSubtitleInput">Hero Subtitle</label>
                            <textarea id="heroSubtitleInput" class="form-control" rows="2"></textarea>
                        </div>
                        <h4>Badges</h4>
                        <div class="form-group">
                            <label for="badge1TextInput">Badge 1 Text</label>
                            <input id="badge1TextInput" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="badge2TextInput">Badge 2 Text</label>
                            <input id="badge2TextInput" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="badge3TextInput">Badge 3 Text</label>
                            <input id="badge3TextInput" class="form-control">
                        </div>
                        <h4>Contact Section</h4>
                        <div class="form-group">
                            <label for="contactFormTitleInput">Contact Title</label>
                            <input id="contactFormTitleInput" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="contactFormSubtitleInput">Contact Subtitle</label>
                            <textarea id="contactFormSubtitleInput" class="form-control" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="locationTextInput">Location Text</label>
                            <input id="locationTextInput" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="phoneTextInput">Phone Text</label>
                            <input id="phoneTextInput" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="emailTextInput">Email Text</label>
                            <input id="emailTextInput" class="form-control">
                        </div>
                        <h4>Footer</h4>
                        <div class="form-group">
                            <label for="footerText1Input">Footer Line 1</label>
                            <input id="footerText1Input" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="footerText2Input">Footer Line 2</label>
                            <input id="footerText2Input" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="footerText3Input">Footer Line 3</label>
                            <input id="footerText3Input" class="form-control">
                        </div>
                        <button type="submit" class="btn btn-primary">Save Website Settings</button>
                    </form>
                </div>

                <div id="assistantTab" class="tab-content">
                    <h3>AI Chat Assistant Settings</h3>
                    <p style="color:var(--color-text-secondary);margin-bottom:1.5rem;">
                        Manage your AI chat assistant settings and customize responses.
                    </p>
                    <div class="form-group">
                        <label style="display:flex;align-items:center;gap:.5rem;cursor:pointer;">
                            <input type="checkbox" id="assistantEnabled" onchange="toggleAssistant()" checked style="width:auto;cursor:pointer;">
                            <span style="font-weight:500;">Enable AI Chat Assistant</span>
                        </label>
                        <p style="color:var(--color-text-secondary);font-size:.875rem;margin-top:.5rem;">
                            Toggle the chat widget on/off for website visitors.
                        </p>
                    </div>
                    <hr style="margin:2rem 0;">
                    <div class="form-group">
                        <label for="assistantGreeting">Welcome Message</label>
                        <textarea id="assistantGreeting" class="form-control" rows="4" placeholder="Enter welcome message...">üëã Namaste! I‚Äôm Harish Footwear‚Äôs assistant.

I can help you with:
‚Ä¢ Product suggestions
‚Ä¢ Stock & size availability
‚Ä¢ Bulk wholesale orders
‚Ä¢ Shop location & contact

Type your question here or send your WhatsApp number,
we‚Äôll reply quickly from +91 6393191774.</textarea>
                        <p style="color:var(--color-text-secondary);font-size:.875rem;margin-top:.5rem;">
                            This message appears when visitors open the chat.
                        </p>
                    </div>
                    <div class="form-group">
                        <label for="assistantTitle">Assistant Name</label>
                        <input type="text" id="assistantTitle" class="form-control" value="Harish Assistant ü§ñ">
                        <p style="color:var(--color-text-secondary);font-size:.875rem;margin-top:.5rem;">
                            The name displayed in the chat header.
                        </p>
                    </div>
                    <div class="form-group">
                        <label for="assistantSubtitle">Assistant Subtitle</label>
                        <input type="text" id="assistantSubtitle" class="form-control" value="Ask me anything about footwear!">
                        <p style="color:var(--color-text-secondary);font-size:.875rem;margin-top:.5rem;">
                            Subtitle text under the assistant name.
                        </p>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="saveAssistantSettings()">Save Assistant Settings</button>
                    <button type="button" class="btn btn-secondary" onclick="resetAssistantSettings()" style="margin-left:.5rem;background:var(--color-text-secondary);">
                        Reset to Defaults
                    </button>
                </div>

                <div id="settingsTab" class="tab-content">
                    <h3>Admin Account</h3>
                    <p style="color:var(--color-text-secondary);margin-bottom:1.5rem;">
                        Change the username and password used to log in to this dashboard.
                    </p>
                    <div class="form-group">
                        <label for="adminUsernameInput">Username</label>
                        <input id="adminUsernameInput" class="form-control" value="Aditya">
                    </div>
                    <div class="form-group">
                        <label for="adminPasswordInput">Password</label>
                        <input id="adminPasswordInput" class="form-control" type="password" value="Aditya@9050">
                    </div>
                    <button type="button" class="btn btn-primary" onclick="saveAdminCredentials()">Save Account Settings</button>
                    <button type="button" class="btn btn-danger" onclick="handleLogout()" style="margin-left:.5rem;">Logout</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
const firebaseConfig = {
    apiKey: "AIzasyDWPorADXy≈Çem4El5xAU4x_n3aeuXzA",
    authDomain: "harishfootwear-5986c.firebaseapp.com",
    projectId: "harishfootwear-5986c",
    storageBucket: "harishfootwear-5986c.appspot.com",
    messagingSenderId: "416642383698",
    appId: "1:618642383698:web:f643110e08ef8fa9c633"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let products = [];
let messages = [];
let analytics = {
    totalVisitors: 0,
    totalViews: 0,
    todayVisitors: 0,
    todayDate: '',
    devices: { desktop: 0, mobile: 0, tablet: 0 },
    activities: [],
    last7Days: []
};
let websiteContent = {
    heroTitle: 'Budget Shoe Bazaar: Wholesale Footwear at Unbeatable Prices ‚ú®',
    heroSubtitle: 'Explore Harish Footwear, the ultimate wholesale distributor for top brands like Nike, Adidas, Puma, and more.',
    badge1Text: 'Top Brands',
    badge2Text: 'Wholesale Prices',
    badge3Text: 'Bulk Orders',
    contactFormTitle: 'Contact Harish Footwear',
    contactFormSubtitle: 'Fill the contact form or call -6393191774',
    locationText: 'Bansdih, UP-277202',
    phoneText: '+91 6393191774',
    emailText: 'harishfootwear950@gmail.com',
    footerText1: '¬© 2025 Harish Footwear. All rights reserved.',
    footerText2: 'Wholesale Distributor - Nike, Adidas, Puma & More',
    footerText3: 'üåê Website Live & Ready for Business'
};
let adminCredentials = { username: 'Aditya', password: 'Aditya@9050' };
let isLoggedIn = false;
let customSections = [];
let assistantSettings = {
    enabled: true,
    greeting: "üëã Namaste! I‚Äôm Harish Footwear‚Äôs assistant.\n\nI can help you with:\n‚Ä¢ Product suggestions\n‚Ä¢ Stock & size availability\n‚Ä¢ Bulk wholesale orders\n‚Ä¢ Shop location & contact\n\nType your question here or send your WhatsApp number,\nwe‚Äôll reply quickly from +91 6393191774.",
    title: 'Harish Assistant ü§ñ',
    subtitle: 'Ask me anything about footwear!'
};

function renderProducts() {
    const grid = document.getElementById('productsGrid');
    if (!grid) return;
    if (!products || products.length === 0) {
        grid.innerHTML = '<p>Loading products...</p>';
        return;
    }
    grid.innerHTML = products.map((product, index) => {
        const imgUrl = product.image ? String(product.image).trim() : '';
        const emoji = product.emoji || 'üëü';
        const hasImage = imgUrl !== '';
        const imageHtml = hasImage
            ? `<img src="${imgUrl}" alt="${product.name || ''}"
                 onerror="this.style.display='none'; if(this.nextElementSibling){this.nextElementSibling.style.display='flex';}">`
            : '';
        const emojiHtml = `<div class="product-image-emoji"
                               style="display:${hasImage ? 'none' : 'flex'};align-items:center;justify-content:center;">
                               ${emoji}
                           </div>`;
        const sizesText = product.sizes ? `Sizes: ${product.sizes}` : '';
        const catColor = (product.category || product.color)
            ? `<div style="font-size:.8rem;color:var(--color-text-secondary);margin-top:.25rem;">
                   ${(product.category || '')}${product.category && product.color ? ' ¬∑ ' : ''}${product.color || ''}
               </div>`
            : '';

                    <button type="button"
                onclick="window.location.href='tel:+916393191774'"
                style="margin-top:0.75rem;padding:0.6rem 1.2rem;border-radius:999px;border:none;background:var(--color-primary);color:#fff;font-size:.9rem;font-weight:500;cursor:pointer;">
                Call for price
            </button>
            ${product.stock && product.stock > 0
                ? `<div class="product-stock">${product.stock} in stock</div>`
                : ''}

    }).join('');
}

async function loadSavedProducts() {
    try {
        const ref = db.collection('products').orderBy('orderIndex', 'asc').orderBy('timestamp', 'desc');
        const snapshot = await ref.get();
        products = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
    } catch (e) { console.error('Failed to load products', e); }
}

async function moveProduct(productId, direction) {
    const index = products.findIndex(p => p.id === productId);
    if (index === -1) return;
    let targetIndex = direction === 'up' ? index - 1 : index + 1;
    if (targetIndex < 0 || targetIndex >= products.length) return;

    [products[targetIndex], products[index]] = [products[index], products[targetIndex]];
    const batch = db.batch();
    batch.update(db.collection('products').doc(products[index].id), { orderIndex: index });
    batch.update(db.collection('products').doc(products[targetIndex].id), { orderIndex: targetIndex });

    try {
        await batch.commit();
        renderProducts();
        renderAdminProducts();
    } catch (error) { console.error(error); }
}

function renderAdminProducts() {
    const tbody = document.getElementById('adminProductsList');
    if (!tbody) return;
    tbody.innerHTML = products.map((p, i) => `
        <tr>
            <td>
                <button class="btn btn-sm" onclick="moveProduct('${p.id}', 'up')" ${i === 0 ? 'disabled' : ''}>‚¨Ü</button>
                <button class="btn btn-sm" onclick="moveProduct('${p.id}', 'down')" ${i === products.length - 1 ? 'disabled' : ''}>‚¨á</button>
            </td>
            <td>${p.emoji || 'üëü'} ${p.brand || ''}</td>
            <td>${p.name || ''}</td>
            <td>‚Çπ${p.price || 0}</td>
            <td>${p.stock || 0}</td>
            <td>
                <button class="btn btn-primary btn-sm" onclick="editProduct('${p.id}')">Edit</button>
                <button class="btn btn-danger btn-sm" onclick="deleteProduct('${p.id}')">Delete</button>
            </td>
        </tr>`).join('');
}

async function handleAddProduct(e) {
    e.preventDefault();

    const brandSelect = document.getElementById('productBrand');
    const brandValue = brandSelect.value === '__custom__'
        ? document.getElementById('customBrandInput').value.trim()
        : brandSelect.value;

    const wholesalePrice = parseInt(document.getElementById('productPrice').value) || 0;
    const mrp = parseInt(document.getElementById('productMrp').value) || 0;
    const discount = parseInt(document.getElementById('productDiscount').value) || 0;

    const data = {
        brand: brandValue || '',
        name: document.getElementById('productName').value.trim(),
        price: wholesalePrice,
        mrp: mrp,
        discount: discount,
        sizes: document.getElementById('productSizes').value.trim(),
        category: document.getElementById('productCategory').value,
        color: document.getElementById('productColor').value.trim(),
        stock: parseInt(document.getElementById('productStock').value) || 0,
        emoji: document.getElementById('productEmoji').value || 'üëü',
        image: document.getElementById('productImage').value.trim(),
        article: document.getElementById('productArticle').value.trim(),
        description: document.getElementById('productDescription').value.trim(),
        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
        orderIndex: products.length
    };

    await db.collection('products').add(data);
    await loadSavedProducts();
    renderProducts();
    renderAdminProducts();
    e.target.reset();
}

async function editProduct(id) {
    const p = products.find(x => x.id === id);
    const n = prompt('New name:', p && p.name ? p.name : '');
    if (n) {
        await db.collection('products').doc(id).update({ name: n });
        await loadSavedProducts();
        renderProducts();
        renderAdminProducts();
    }
}

async function deleteProduct(id) {
    if (confirm('Delete this product?')) {
        await db.collection('products').doc(id).delete();
        await loadSavedProducts();
        renderProducts();
        renderAdminProducts();
    }
}

function handleBrandSelect() {
    const brandSelect = document.getElementById('productBrand');
    const customGroup = document.getElementById('customBrandGroup');
    customGroup.style.display = brandSelect.value === '__custom__' ? 'block' : 'none';
}

async function handleContactSubmit(e) {
    e.preventDefault();
    const d = {
        name: e.target.querySelector('input[type="text"]').value,
        email: e.target.querySelector('input[type="email"]').value,
        message: e.target.querySelector('textarea').value,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
    };
    await db.collection('messages').add(d);
    e.target.reset();
    document.getElementById('contactAlert').innerHTML = '<div class="alert alert-success">Sent!</div>';
}

async function loadMessages() {
    const snap = await db.collection('messages').orderBy('timestamp', 'desc').get();
    messages = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
}

function renderMessages() {
    const container = document.getElementById('messagesList');
    if (!container) return;
    if (!messages.length) {
        container.innerHTML = '<p style="color: var(--color-text-secondary);">No messages yet.</p>';
        return;
    }
    container.innerHTML = messages.map(m => `
        <div style="border:1px solid var(--color-border);padding:1rem;border-radius:8px;margin-bottom:.75rem;">
            <strong>${m.name || ''}</strong> &lt;${m.email || ''}&gt;<br>
            <span style="font-size:.9rem;">${m.message || ''}</span><br>
            <button class="btn btn-danger btn-sm" onclick="deleteMessage('${m.id}')">Delete</button>
        </div>`).join('');
}

async function deleteMessage(id) {
    await db.collection('messages').doc(id).delete();
    await loadMessages();
    renderMessages();
}

function loadAnalytics() {
    const stored = localStorage.getItem('harish_analytics');
    if (stored) {
        try { analytics = JSON.parse(stored); } catch (e) {}
    }
}
function saveAnalytics() {
    localStorage.setItem('harish_analytics', JSON.stringify(analytics));
}
function trackVisitor() {
    loadAnalytics();
    analytics.totalViews += 1;
    analytics.totalVisitors += 1;

    const now = new Date();
    const todayLabel = now.toLocaleDateString('en-IN', { month: 'short', day: '2-digit' });

    if (analytics.todayDate !== todayLabel) {
        analytics.todayDate = todayLabel;
        analytics.todayVisitors = 0;
    }
    analytics.todayVisitors += 1;

    const ua = navigator.userAgent || '';
    if (/tablet/i.test(ua)) analytics.devices.tablet += 1;
    else if (/mobile/i.test(ua)) analytics.devices.mobile += 1;
    else analytics.devices.desktop += 1;

    if (!Array.isArray(analytics.last7Days)) analytics.last7Days = [];
    const existing = analytics.last7Days.find(d => d.dateLabel === todayLabel);
    if (existing) existing.views += 1;
    else {
        analytics.last7Days.push({ dateLabel: todayLabel, views: 1 });
        if (analytics.last7Days.length > 7) analytics.last7Days.shift();
    }

    saveAnalytics();
    renderAnalytics();
}
function renderAnalytics() {
    const totalVisitorsEl = document.getElementById('totalVisitors');
    if (!totalVisitorsEl) return;

    const totalViewsEl = document.getElementById('totalViews');
    const todayVisitorsEl = document.getElementById('todayVisitors');
    const todayDateEl = document.getElementById('todayDate');
    const desktopCountEl = document.getElementById('desktopCount');
    const mobileCountEl = document.getElementById('mobileCount');
    const tabletCountEl = document.getElementById('tabletCount');

    totalVisitorsEl.textContent = analytics.totalVisitors || 0;
    totalViewsEl.textContent = analytics.totalViews || 0;
    todayVisitorsEl.textContent = analytics.todayVisitors || 0;
    todayDateEl.textContent = analytics.todayDate || '';

    const totalDevices = (analytics.devices.desktop || 0) + (analytics.devices.mobile || 0) + (analytics.devices.tablet || 0) || 1;
    const pc = n => Math.round((n / totalDevices) * 100);
    desktopCountEl.textContent = `${analytics.devices.desktop || 0} (${pc(analytics.devices.desktop || 0)}%)`;
    mobileCountEl.textContent = `${analytics.devices.mobile || 0} (${pc(analytics.devices.mobile || 0)}%)`;
    tabletCountEl.textContent = `${analytics.devices.tablet || 0} (${pc(analytics.devices.tablet || 0)}%)`;
}

function openAdminPanel() {
    document.getElementById('adminModal').classList.add('active');
    if (isLoggedIn) showDashboard(); else showLogin();
}
function closeAdminPanel() {
    document.getElementById('adminModal').classList.remove('active');
}
function showLogin() {
    document.getElementById('modalTitle').textContent = 'Admin Login';
    document.getElementById('loginSection').style.display = 'block';
    document.getElementById('dashboardSection').style.display = 'none';
}
function showDashboard() {
    document.getElementById('modalTitle').textContent = 'Admin Dashboard';
    document.getElementById('loginSection').style.display = 'none';
    document.getElementById('dashboardSection').style.display = 'block';
    renderAdminProducts();
    renderMessages();
    renderAnalytics();
    renderSections();
}
function handleLogin(e) {
    e.preventDefault();
    const u = document.getElementById('username').value;
    const p = document.getElementById('password').value;
    const alertBox = document.getElementById('loginAlert');
    if (u === adminCredentials.username && p === adminCredentials.password) {
        isLoggedIn = true;
        alertBox.innerHTML = '<div class="alert alert-success">Login successful!</div>';
        showDashboard();
    } else {
        alertBox.innerHTML = '<div class="alert alert-error">Invalid credentials.</div>';
    }
}
function handleLogout() {
    isLoggedIn = false;
    showLogin();
}
function switchTab(tab) {
    document.querySelectorAll('.admin-tab').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.querySelector(`.admin-tab[onclick="switchTab('${tab}')"]`).classList.add('active');
    document.getElementById(tab + 'Tab').classList.add('active');
    if (tab === 'messages') loadMessages().then(renderMessages);
    else if (tab === 'analytics') renderAnalytics();
    else if (tab === 'products') renderAdminProducts();
    else if (tab === 'sections') loadSections();
}

function toggleAiChat() {
    const w = document.getElementById('aiChatWidget');
    if (!w) return;
    if (w.style.display === 'none' || !w.style.display) w.style.display = 'block';
    else w.style.display = 'none';
}
function appendChatMessage(text, from = 'user') {
    const container = document.getElementById('aiChatMessages');
    const bubble = document.createElement('div');
    bubble.style.marginBottom = '0.5rem';
    bubble.style.fontSize = '0.875rem';
    bubble.style.maxWidth = '90%';
    bubble.style.padding = '0.6rem 0.8rem';
    bubble.style.borderRadius = '10px';
    if (from === 'user') {
        bubble.style.marginLeft = 'auto';
        bubble.style.background = '#e5e7eb';
    } else {
        bubble.style.background = 'linear-gradient(135deg,#e0f2fe,#dbeafe)';
    }
    bubble.textContent = text;
    container.appendChild(bubble);
    container.scrollTop = container.scrollHeight;
}
function handleAiChat(e) {
    e.preventDefault();
    const input = document.getElementById('aiChatInput');
    const text = input.value.trim();
    if (!text) return;
    appendChatMessage(text, 'user');
    const reply = 'Thanks for your message! For detailed product and bulk order help, please share your WhatsApp number or call us on +91 6393191774.';
    appendChatMessage(reply, 'bot');
    input.value = '';
}

async function loadWebsiteSettings() {
    try {
        const docSnap = await db.collection('settings').doc('website').get();
        if (docSnap.exists) websiteContent = { ...websiteContent, ...docSnap.data() };
    } catch (e) {}
    updatePageContent();
    fillWebsiteForm();
}
function updatePageContent() {
    document.getElementById('heroTitle').textContent = websiteContent.heroTitle;
    document.getElementById('heroSubtitle').textContent = websiteContent.heroSubtitle;
    document.getElementById('badge1Text').textContent = websiteContent.badge1Text;
    document.getElementById('badge2Text').textContent = websiteContent.badge2Text;
    document.getElementById('badge3Text').textContent = websiteContent.badge3Text;
    document.getElementById('contactFormTitle').textContent = websiteContent.contactFormTitle;
    document.getElementById('contactFormSubtitle').textContent = websiteContent.contactFormSubtitle;
    document.getElementById('locationText').textContent = websiteContent.locationText;
    document.getElementById('phoneText').textContent = websiteContent.phoneText;
    document.getElementById('emailText').textContent = websiteContent.emailText;
    document.getElementById('footerText1').textContent = websiteContent.footerText1;
    document.getElementById('footerText2').textContent = websiteContent.footerText2;
    document.getElementById('footerText3').textContent = websiteContent.footerText3;
}
function fillWebsiteForm() {
    const w = websiteContent;
    const setVal = (id, v) => { const el = document.getElementById(id); if (el) el.value = v || ''; };
    setVal('heroTitleInput', w.heroTitle);
    setVal('heroSubtitleInput', w.heroSubtitle);
    setVal('badge1TextInput', w.badge1Text);
    setVal('badge2TextInput', w.badge2Text);
    setVal('badge3TextInput', w.badge3Text);
    setVal('contactFormTitleInput', w.contactFormTitle);
    setVal('contactFormSubtitleInput', w.contactFormSubtitle);
    setVal('locationTextInput', w.locationText);
    setVal('phoneTextInput', w.phoneText);
    setVal('emailTextInput', w.emailText);
    setVal('footerText1Input', w.footerText1);
    setVal('footerText2Input', w.footerText2);
    setVal('footerText3Input', w.footerText3);
}
async function saveWebsiteSettings(e) {
    e.preventDefault();
    const getVal = id => document.getElementById(id).value;
    websiteContent.heroTitle = getVal('heroTitleInput');
    websiteContent.heroSubtitle = getVal('heroSubtitleInput');
    websiteContent.badge1Text = getVal('badge1TextInput');
    websiteContent.badge2Text = getVal('badge2TextInput');
    websiteContent.badge3Text = getVal('badge3TextInput');
    websiteContent.contactFormTitle = getVal('contactFormTitleInput');
    websiteContent.contactFormSubtitle = getVal('contactFormSubtitleInput');
    websiteContent.locationText = getVal('locationTextInput');
    websiteContent.phoneText = getVal('phoneTextInput');
    websiteContent.emailText = getVal('emailTextInput');
    websiteContent.footerText1 = getVal('footerText1Input');
    websiteContent.footerText2 = getVal('footerText2Input');
    websiteContent.footerText3 = getVal('footerText3Input');
    await db.collection('settings').doc('website').set(websiteContent);
    updatePageContent();
    alert('Website settings saved.');
}

async function loadSections() {
    try {
        const snap = await db.collection('sections').orderBy('orderIndex', 'asc').get();
        customSections = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
    } catch (e) {
        customSections = [];
    }
    renderSections();
}

async function addSection(type) {
    const base = {
        type,
        title: type.charAt(0).toUpperCase() + type.slice(1),
        content: '',
        orderIndex: customSections.length,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
    };
    const docRef = await db.collection('sections').add(base);
    customSections.push({ id: docRef.id, ...base });
    renderSections();
}

async function updateSection(id, updates) {
    const idx = customSections.findIndex(s => s.id === id);
    if (idx === -1) return;
    customSections[idx] = { ...customSections[idx], ...updates };
    await db.collection('sections').doc(id).update(updates);
    renderSections();
}
function updateSectionTitle(id, value) {
    updateSection(id, { title: value });
}
function updateSectionContent(id, value) {
    updateSection(id, { content: value });
}

async function moveSection(id, direction) {
    const index = customSections.findIndex(s => s.id === id);
    if (index === -1) return;
    let targetIndex = direction === 'up' ? index - 1 : index + 1;
    if (targetIndex < 0 || targetIndex >= customSections.length) return;

    const a = customSections[index];
    const b = customSections[targetIndex];
    [customSections[targetIndex], customSections[index]] = [a, b];

    const batch = db.batch();
    batch.update(db.collection('sections').doc(a.id), { orderIndex: targetIndex });
    batch.update(db.collection('sections').doc(b.id), { orderIndex: index });
    await batch.commit();
    renderSections();
}

async function deleteSection(id) {
    if (!confirm('Delete this section?')) return;
    await db.collection('sections').doc(id).delete();
    customSections = customSections.filter(s => s.id !== id);
    const batch = db.batch();
    customSections.forEach((s, i) => {
        s.orderIndex = i;
        batch.update(db.collection('sections').doc(s.id), { orderIndex: i });
    });
    await batch.commit();
    renderSections();
}

function renderSections() {
    const list = document.getElementById('sectionsList');
    if (list) {
        if (!customSections.length) {
            list.innerHTML = '<p style="color: var(--color-text-secondary);">No extra sections added yet.</p>';
        } else {
            list.innerHTML = customSections.map((s, i) => {
                const preview = (s.content || '').split(/\r?\n/)[0].slice(0,40) || '(empty)';
                return `
                    <div style="border:1px solid var(--color-border);border-radius:8px;padding:1rem;margin-bottom:0.75rem;">
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div>
                                <strong>${s.title || s.type}</strong>
                                <span style="font-size:.8rem;color:var(--color-text-secondary);">[${s.type}]</span><br>
                                <span style="font-size:.8rem;color:var(--color-text-secondary);">${preview}</span>
                            </div>
                            <div style="display:flex;gap:.25rem;">
                                <button class="btn btn-sm" onclick="moveSection('${s.id}','up')" ${i===0?'disabled':''}>‚¨Ü</button>
                                <button class="btn btn-sm" onclick="moveSection('${s.id}','down')" ${i===customSections.length-1?'disabled':''}>‚¨á</button>
                                <button class="btn btn-primary btn-sm" onclick="openSectionEditor('${s.id}')">Edit</button>
                                <button class="btn btn-danger btn-sm" onclick="deleteSection('${s.id}')">Delete</button>
                            </div>
                        </div>
                    </div>`;
            }).join('');
        }
    }

    const container = document.getElementById('customSectionsContainer');
    if (!container) return;
    if (!customSections.length) {
        container.innerHTML = '';
        return;
    }

    container.innerHTML = customSections.map(s => {
        if (s.type === 'hero') {
            return `
                <section class="hero" style="margin-top:2rem;">
                    <h1>${s.title || 'New Hero Section'}</h1>
                    <p>${s.content || ''}</p>
                </section>`;
        }
        if (s.type === 'card') {
            return `
                <div style="max-width:1200px;margin:2rem auto;">
                    <div style="background:#fff;border-radius:16px;padding:1.5rem;box-shadow:0 8px 20px rgba(0,0,0,.05);">
                        <h3 style="margin-bottom:0.5rem;">${s.title || 'New Card'}</h3>
                        <p style="color:var(--color-text-secondary);white-space:pre-line;">${s.content || ''}</p>
                    </div>
                </div>`;
        }
        if (s.type === 'image') {
            const url = (s.content || '').trim();
            return `
                <div style="max-width:800px;margin:2rem auto;">
                    <img src="${url}" alt="${s.title || 'Section image'}"
                         style="width:100%;border-radius:16px;object-fit:cover;">
                </div>`;
        }
        if (s.type === 'gallery') {
            const urls = (s.content || '').split(/\s+/).filter(Boolean);
            const items = urls.map(u => `
                <div style="border-radius:12px;overflow:hidden;background:#f3f4f6;">
                    <img src="${u}" alt="${s.title || 'Gallery image'}"
                         style="width:100%;height:200px;object-fit:cover;">
                </div>`).join('');
            return `
                <div style="max-width:1200px;margin:2rem auto;">
                    <h3 style="margin-bottom:1rem;">${s.title || 'Gallery'}</h3>
                    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;">
                        ${items || '<p style="color:var(--color-text-secondary);">Add image URLs separated by space or new line.</p>'}
                    </div>
                </div>`;
        }
        if (s.type === 'spacer') {
            return `<div style="height:40px;"></div>`;
        }
        return `
            <div style="max-width:800px;margin:2rem auto;text-align:center;">
                <h3>${s.title || 'New Section'}</h3>
                <p style="color:var(--color-text-secondary);margin-top:0.5rem;white-space:pre-line;">${s.content || ''}</p>
            </div>`;
    }).join('');
}

function openSectionEditor(id) {
    const s = customSections.find(x => x.id === id);
    if (!s) return;
    const newTitle = prompt('Section title:', s.title || '');
    if (newTitle === null) return;
    const newContent = prompt('Section content (for image: paste URL, for gallery: multiple URLs):', s.content || '');
    updateSection(id, { title: newTitle, content: newContent || '' });
}

function loadAssistantSettingsIntoUI() {
    const g = document.getElementById('assistantGreeting');
    if (g && assistantSettings.greeting) g.value = assistantSettings.greeting;
    const t = document.getElementById('assistantTitle');
    if (t) t.value = assistantSettings.title;
    const st = document.getElementById('assistantSubtitle');
    if (st) st.value = assistantSettings.subtitle;
    const chk = document.getElementById('assistantEnabled');
    if (chk) chk.checked = assistantSettings.enabled;

    document.getElementById('assistantTitleHeader').textContent = assistantSettings.title;
    document.getElementById('assistantSubtitleHeader').textContent = assistantSettings.subtitle;

    const btn = document.getElementById('aiChatButton');
    if (btn) btn.style.display = assistantSettings.enabled ? 'flex' : 'none';
    if (!assistantSettings.enabled) document.getElementById('aiChatWidget').style.display = 'none';

    const greetBlock = document.getElementById('assistantGreetingBlock');
    if (greetBlock) greetBlock.innerText = assistantSettings.greeting.replace(/\n/g, '\n');
}
function toggleAssistant() {
    const chk = document.getElementById('assistantEnabled');
    assistantSettings.enabled = chk.checked;
    loadAssistantSettingsIntoUI();
}
async function saveAssistantSettings() {
    assistantSettings.greeting = document.getElementById('assistantGreeting').value;
    assistantSettings.title = document.getElementById('assistantTitle').value;
    assistantSettings.subtitle = document.getElementById('assistantSubtitle').value;
    await db.collection('settings').doc('assistant').set(assistantSettings);
    loadAssistantSettingsIntoUI();
    alert('Assistant settings saved.');
}
function resetAssistantSettings() {
    assistantSettings = {
        enabled: true,
        greeting: "üëã Namaste! I‚Äôm Harish Footwear‚Äôs assistant.\n\nI can help you with:\n‚Ä¢ Product suggestions\n‚Ä¢ Stock & size availability\n‚Ä¢ Bulk wholesale orders\n‚Ä¢ Shop location & contact\n\nType your question here or send your WhatsApp number,\nwe‚Äôll reply quickly from +91 6393191774.",
        title: 'Harish Assistant ü§ñ',
        subtitle: 'Ask me anything about footwear!'
    };
    loadAssistantSettingsIntoUI();
}

async function saveAdminCredentials() {
    adminCredentials.username = document.getElementById('adminUsernameInput').value;
    adminCredentials.password = document.getElementById('adminPasswordInput').value;
    await db.collection('settings').doc('admin').set(adminCredentials);
    alert('Admin credentials updated.');
}

function checkAdminAccess() {
    const params = new URLSearchParams(window.location.search);
    if (params.get('admin') === 'true') {
        document.getElementById('adminBadge').classList.add('visible');
    }
}

async function initialize() {
    await loadWebsiteSettings();
    try {
        const adminDoc = await db.collection('settings').doc('admin').get();
        if (adminDoc.exists) adminCredentials = { ...adminCredentials, ...adminDoc.data() };
    } catch (e) {}
    try {
        const aDoc = await db.collection('settings').doc('assistant').get();
        if (aDoc.exists) assistantSettings = { ...assistantSettings, ...aDoc.data() };
    } catch (e) {}
    loadAssistantSettingsIntoUI();
    await loadSavedProducts();
    renderProducts();
    await loadSections();
    trackVisitor();
    checkAdminAccess();
}
initialize();
</script>
</body>
</html>
